# Компоненты системы

## Agent
Приложение, на котором игрок запускает свой алгоритм управления командой танков, так же может послать запрос о получении информации турниров, рейтинга и тд.
## API Gateway
Шлюз, который принимает запросы от клиентского приложения, проверяет валидность игрока (JWT-токена пока не предусмотрен), отправляет запросы на соответсвующие  микросервисы.
## Authorization serviсe
Микросервис авторизации и аутентификации. Пока в простом варианте он записывает в User Service Inside (БД) данные новых пользователей, и получает информацию, что данный пользователь зарегистрирован

### Endpoints
1)	registerUser

Message registerUserRequest   
{  
        string name; // имя  
    string password; // пароль  
    string params; // доп параметры  
}  
Message registerUserResponse   
{  
  string name;   
  string password;   
  int status; // status – ид ошибки 0 – все ОК, 1 – какая-то ошибка
  uint64 idUser; // ид пользователя  
}	   

2)	checkUser // проверка, что такой пользователь зарегестрирован
   
Message checkUserRequest  
{    
  string name; // имя  
  string password; // пароль  
  string params; // доп параметры    
}  
Message checkUserResponse  
{  
  string name; // имя  
  string password; // пароль  
  string params; // доп параметры  
  int status; // код ошибки, 0 – все ок, 1 – такого пользователя не существует   
  uint64 idUser; // ид пользователя  
}  
    
## Tourney Service
Сервис боев, который умеет запускать новый бой в новом потоке, при завершении боя сохраняет всю информацию о нем БД боев (User Service Battle Rating), хранит и отправляет информацию о скором начале боя
### Endpoints	
1)	newBattle // создание нового боя
   
Message newBattleRequest  
{  
  string typeBattle; // тип боя, напр “tourney” “userBattleSingle” “userBattleParty”  
  string idPart; // поле id участников боя  
  string params; // доп параметры  
}  
Message newBattleResponse  
{  
  int status; // код ошибки, 0 – все ок, 1 – ошибка создания  
}  

2)	addUserToBattle // добавить игрока в бой в очереди (не начат, но создан)
   
Message addUserToBattleRequest  
{  
  uint64 idBattle; // id боя  
  uint64 idUser; // ид пользователя  
}  
Message addUserToBattleResponse  
{  
  int status; // код ошибки, 0 – все ок, 1 – ошибка …  
}  

3)	saveBattle // Сохраняем информацию о законченном бое – сервис отсылает
   
Message saveBattleRequest  
{  
  uint64 idBattle; // id боя  
  string result; // результаты боя  
}  
Message saveBattleResponse  
{  
  int status; // код ошибки, 0 – все ок, 1 – ошибка …  
}

4)	notificationBattle // Уведомление о скором начале боя
   
Message notificationBattleRequest  
{  
  uint64 idBattle; // id боя  
  uint64 idPlayer; // id участника  
}  
Message notificationBattleResponse  
{  
  int status; // код ошибки, 0 – все ок, 1 – ошибка …  
}  

5)	сommandToBattle // участник отправляет команду в уже текущий бой  

Message сommandToBattleRequest  
{  
  uint64 idBattle; // id боя  
  uint64 idPlayer; // id участника отправившего запрос  
  string typeCommand; // тип команды  
}  
Message сommandToBattleResponse  
{  
  int status; // код ошибки, 0 – команда поставлена в очередь, 1 – команду выполнить не возможно  
}  

## SpaceBattle Service
Сервис, который просто выполняет команды боя, общается с Tourney Service, его может быть несколько столько сколько боев, у каждого конкретного есть своя расширяемая фабрика IoC.  
1)	сommandToBattle // участник отправляет команду в уже текущий бой
   
Message сommandToBattleRequest  
{  
  uint64 idBattle; // id боя  
  uint64 idPlayer; // id участника отправившего запрос  
  string typeCommand; // тип команды  
}  
Message сommandToBattleResponse  
{  
  int status; // код ошибки, 0 – команда поставлена в очередь, 1 – команду выполнить не возможно  
}  

## User Service Inside
БД с хранением информации о пользователях.
## User Service Battle Rating
БД с хранением информации о битвах и рейтингах каждого пользователя
## Information Message Service
Сервис с работой запросов о информации пользователя(рейтинг, бои).




